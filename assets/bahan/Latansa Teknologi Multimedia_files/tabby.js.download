(function(root,factory){if(typeof define==='function'&&define.amd){define([],factory(root));}else if(typeof exports==='object'){module.exports=factory(root);}else{root.tabby=factory(root);}})(typeof global!=='undefined'?global:this.window||this.global,function(root){'use strict';var tabby={};var supports='querySelector'in document&&'addEventListener'in root&&'classList'in document.createElement('_');var settings;var defaults={selector:'[data-tab]',toggleActiveClass:'active',contentActiveClass:'active',initClass:'js-tabby',callback:function(){}};var forEach=function(collection,callback,scope){if(Object.prototype.toString.call(collection)==='[object Object]'){for(var prop in collection){if(Object.prototype.hasOwnProperty.call(collection,prop)){callback.call(scope,collection[prop],prop,collection);}}}else{for(var i=0,len=collection.length;i<len;i++){callback.call(scope,collection[i],i,collection);}}};var extend=function(){var extended={};var deep=false;var i=0;var length=arguments.length;if(Object.prototype.toString.call(arguments[0])==='[object Boolean]'){deep=arguments[0];i++;}var merge=function(obj){for(var prop in obj){if(Object.prototype.hasOwnProperty.call(obj,prop)){if(deep&&Object.prototype.toString.call(obj[prop])==='[object Object]'){extended[prop]=extend(true,extended[prop],obj[prop]);}else{extended[prop]=obj[prop];}}}};for(;i<length;i++){var obj=arguments[i];merge(obj);}return extended;};var getClosest=function(elem,selector){var firstChar=selector.charAt(0);var attribute,value;if(firstChar==='['){selector=selector.substr(1,selector.length-2);attribute=selector.split('=');if(attribute.length>1){value=true;attribute[1]=attribute[1].replace(/"/g,'').replace(/'/g,'');}}for(;elem&&elem!==document;elem=elem.parentNode){if(firstChar==='.'){if(elem.classList.contains(selector.substr(1))){return elem;}}if(firstChar==='#'){if(elem.id===selector.substr(1)){return elem;}}if(firstChar==='['){if(elem.hasAttribute(attribute[0])){if(value){if(elem.getAttribute(attribute[0])===attribute[1]){return elem;}}else{return elem;}}}if(elem.tagName.toLowerCase()===selector){return elem;}}return null;};var getSiblings=function(elem){var siblings=[];var sibling=elem.parentNode.firstChild;for(;sibling;sibling=sibling.nextSibling){if(sibling.nodeType===1&&sibling!==elem){siblings.push(sibling);}}return siblings;};var stopVideos=function(content,activeClass){if(!content.classList.contains(activeClass)){var iframe=content.querySelector('iframe');var video=content.querySelector('video');if(iframe){var iframeSrc=iframe.src;iframe.src=iframeSrc;}if(video){video.pause();}}};var hideOtherTabs=function(toggle,tab,settings){var isLinkList=toggle.parentNode.tagName.toLowerCase()==='li'?true:false;var toggleSiblings=isLinkList?getSiblings(toggle.parentNode):getSiblings(toggle);var tabSiblings=getSiblings(tab);forEach(toggleSiblings,function(sibling){sibling.classList.remove(settings.toggleActiveClass);if(isLinkList){sibling.querySelector(settings.selector).classList.remove(settings.toggleActiveClass);}});forEach(tabSiblings,function(tab){if(tab.classList.contains(settings.contentActiveClass)){stopVideos(tab);tab.classList.remove(settings.contentActiveClass);}});};var showTargetTabs=function(toggle,tabs,settings){var toggleParent=toggle.parentNode;toggle.classList.add(settings.toggleActiveClass);if(toggleParent&&toggleParent.tagName.toLowerCase()==='li'){toggleParent.classList.add(settings.toggleActiveClass);}forEach(tabs,function(tab){tab.classList.add(settings.contentActiveClass);});};tabby.toggleTab=function(toggle,tabID,options,event){var settings=extend(settings||defaults,options||{});var tabs=document.querySelectorAll(tabID);hideOtherTabs(toggle,tabs[0],settings);showTargetTabs(toggle,tabs,settings);settings.callback(toggle,tabID);};var eventHandler=function(event){var toggle=getClosest(event.target,settings.selector);if(toggle){event.preventDefault();tabby.toggleTab(toggle,toggle.getAttribute('data-tab'),settings);}};tabby.destroy=function(){if(!settings)return;document.documentElement.classList.remove(settings.initClass);document.removeEventListener('click',eventHandler,false);settings=null;};tabby.init=function(options){if(!supports)return;tabby.destroy();settings=extend(defaults,options||{});document.documentElement.classList.add(settings.initClass);document.addEventListener('click',eventHandler,false);};return tabby;});